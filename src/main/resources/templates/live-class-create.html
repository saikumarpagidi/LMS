<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Create Live Class</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Resource center filtering
      const loc = document.getElementById("location");
      const rc  = document.getElementById("resourceCenterName");
      loc.addEventListener("change", () => {
        const sel = loc.value;
        Array.from(rc.options).forEach(o =>
          o.hidden = o.value && o.getAttribute("data-location") !== sel
        );
        rc.value = "";
      });

      // Prevent back‐dating
      const now = new Date();
      const pad = n => String(n).padStart(2, '0');
      const iso = `${now.getFullYear()}-${pad(now.getMonth()+1)}-${pad(now.getDate())}T${pad(now.getHours())}:${pad(now.getMinutes())}`;
      document.querySelectorAll('input[type="datetime-local"]').forEach(input => {
        input.min = iso;
      });
    });
  </script>
</head>
<body class="bg-gray-50 p-6">
  <div class="max-w-2xl mx-auto bg-white p-8 rounded shadow">
    <h1 class="text-2xl font-bold mb-6 text-center">Create Live Class Schedule</h1>
    <form th:action="@{/live-classes/create}"
          th:object="${liveClassSchedule}"
          method="post"
          class="space-y-4">

      <!-- Course Selection -->
      <div>
        <label for="course" class="block font-medium mb-1">Select Course</label>
        <select id="course"
                th:field="*{course.id}"
                class="w-full border rounded p-2"
                required>
          <option value="" disabled selected>-- Select Course --</option>
          <option th:each="c : ${courses}"
                  th:value="${c.id}"
                  th:text="${c.courseName}">
          </option>
        </select>
      </div>

      <!-- Location -->
      <div>
        <label for="location" class="block font-medium mb-1">Select Location</label>
        <select id="location"
                th:field="*{location}"
                class="w-full border rounded p-2"
                required>
          <option value="" disabled selected>-- Select Location --</option>
          <option value="PMU Noida">PMU Noida</option>
          <option value="PMU Mohali">PMU Mohali</option>
        </select>
      </div>

      <!-- Resource Center -->
      <div>
        <label for="resourceCenterName" class="block font-medium mb-1">Select Resource Center</label>
        <select id="resourceCenterName"
                th:field="*{resourceCenterName}"
                class="w-full border rounded p-2"
                required>
          <option value="" disabled selected>-- Select Resource Center --</option>
          <option th:each="rc : ${resourceCenters}"
                  th:value="${rc.resourceCenter}"
                  th:text="${rc.resourceCenter}"
                  th:attr="data-location=${rc.location}">
          </option>
        </select>
      </div>

      <!-- Topic -->
      <div>
        <label class="block font-medium mb-1">Topic</label>
        <input type="text"
               th:field="*{topic}"
               class="w-full border rounded p-2"
               placeholder="Enter live class topic"
               required>
      </div>

      <!-- Description -->
      <div>
        <label class="block font-medium mb-1">Description</label>
        <textarea th:field="*{description}"
                  class="w-full border rounded p-2"
                  placeholder="Brief description"
                  required></textarea>
      </div>

      <!-- Start & End Time -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block font-medium mb-1">Start Time</label>
          <input type="datetime-local"
                 th:field="*{startTime}"
                 class="w-full border rounded p-2"
                 required>
        </div>
        <div>
          <label class="block font-medium mb-1">End Time</label>
          <input type="datetime-local"
                 th:field="*{endTime}"
                 class="w-full border rounded p-2"
                 required>
        </div>
      </div>

      <!-- Timezone -->
      <div>
        <label class="block font-medium mb-1">Timezone</label>
        <input type="text"
               th:field="*{timezone}"
               class="w-full border rounded p-2"
               placeholder="Asia/Kolkata"
               required>
      </div>

      <!-- Google Meet Link -->
      <div>
        <label class="block font-medium mb-1">Google Meet Link</label>
        <input type="url"
               th:field="*{liveClassLink}"
               class="w-full border rounded p-2"
               placeholder="https://meet.google.com/xxx-xxxx-xxx"
               required>
      </div>

      <!-- Submit -->
      <div class="text-center">
        <button type="submit"
                class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
          Create Live Class
        </button>
      </div>
    </form>
  </div>
</body>
</html>
